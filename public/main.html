<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
    <meta name="description" content="">
    <meta name="author" content="Dragos Stoica">
    <title>Risk Accounting - Dashboard</title>

    <link rel="canonical" href="https://rasb.ddns.net/">
    <link rel="icon" href="/img/rasb_icon.png" sizes="any" type="image/png">


    <!-- Load required Bootstrap and BootstrapVue CSS -->
    <link type="text/css" rel="stylesheet" href="https://unpkg.com/bootstrap@4.6.1/dist/css/bootstrap.min.css" />
    <link type="text/css" rel="stylesheet" href="https://unpkg.com/bootstrap-vue@2.22.0/dist/bootstrap-vue.min.css" />

    <!-- Load polyfills to support older browsers -->
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es2015%2CIntersectionObserver"
        crossorigin="anonymous"></script>

    <!-- Load Vue followed by BootstrapVue -->
    <script src="https://unpkg.com/vue@2.6.12/dist/vue.min.js"></script>
    <script src="https://unpkg.com/bootstrap-vue@2.22.0/dist/bootstrap-vue.min.js"></script>

    <!-- Load the following for BootstrapVueIcons support -->
    <script src="https://unpkg.com/bootstrap-vue@2.22.0/dist/bootstrap-vue-icons.min.js"></script>

    <script>
        doCheckSession()

        // Example POST method implementation:
        async function postData(url = '', data = {}) {
            // Default options are marked with *
            const response = await fetch(url, {
                method: 'POST', // *GET, POST, PUT, DELETE, etc.
                mode: 'cors', // no-cors, *cors, same-origin
                cache: 'no-cache', // *default, no-cache, reload, force-cache, only-if-cached
                credentials: 'same-origin', // include, *same-origin, omit
                headers: {
                    'Content-Type': 'application/json'
                    // 'Content-Type': 'application/x-www-form-urlencoded',
                },
                redirect: 'follow', // manual, *follow, error
                referrerPolicy: 'no-referrer', // no-referrer, *no-referrer-when-downgrade, origin, origin-when-cross-origin, same-origin, strict-origin, strict-origin-when-cross-origin, unsafe-url
                body: JSON.stringify(data) // body data type must match "Content-Type" header
            });
            return response; // response object that may contain redirect
        }

        function doCheckSession() {
            postData('/checksession')
                .then(result => {
                    if (result.redirected) {
                        window.location.href = result.url;
                    } else {
                        result.json().then(data => {
                            window.user_data = data.user_data;
                            createVueApp()
                        });
                    }
                })
                .catch((error) => {
                    console.log(error);
                })
        }
    </script>

</head>

<body>
    <main>
        <div id="app" class="w-100">
            <b-container fluid>
                <b-row>
                    <b-col>
                        <b-navbar toggleable="lg" type="light">
                            <b-navbar-brand href="/main.html">
                                <img src="/img/rasb_icon.png" alt="Risk Accounting" height="16px">
                                Home
                            </b-navbar-brand>
                            <b-navbar-toggle target="nav-collapse"></b-navbar-toggle>

                            <b-collapse id="nav-collapse" is-nav>
                                <b-navbar-nav>
                                    <b-nav-item @click="showDashboard()">Dashboard</b-nav-item>
                                    <b-nav-item @click="showTransactions()">Transactions</b-nav-item>
                                </b-navbar-nav>

                                <b-navbar-nav class="ml-auto">
                                    <b-nav-form>
                                        <b-button pill size="sm" class="my-2 my-sm-0" variant="danger"
                                            @click="logout()">Log out</b-button>
                                    </b-nav-form>
                                </b-navbar-nav>
                            </b-collapse>
                        </b-navbar>
                    </b-col>
                </b-row>
                <b-row>
                    <b-col>
                        <keep-alive>
                            <component v-bind:is="theComponent"></component>
                        </keep-alive>
                    </b-col>
                </b-row>
            </b-container>
        </div>
    </main>
    <script src="js/main-components.js"></script>
    <script src="js/main.js"></script>

</body>

</html>